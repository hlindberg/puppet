{
    "$schema":     "http://json-schema.org/draft-04/schema#",
    "title":       "Event",
    "description": "An Event in a Report",
    "type":        "object",
    "properties": {

        "audited": {
            "description": "True if this property is being audited, otherwise false. True in report of `inspect` kind.",
            "type": "boolean"
        },

        "property": {
            "description": "The property for which the event occurred.",
            "type": "string"
        },
        "previous_value": {
            "description": "The value of the property before the change (if any) was applied.",
            oneOf: [
                { "type": "string" }
                { "type": "array" }
                { "type": "object" }
            ]
        },
        "desired_value": {
            "description": "the value specified in the manifest. Absent in reports of `inspect` kind.",
            oneOf: [
                { "type": "string" }
                { "type": "array" }
                { "type": "object" }
            ]
        },
        "historical_value": {
            "description": "The audited value from a previous run of Puppet, if known.
                            Absent in reports of `inspect` kind.",
            oneOf: [
                { "type": "string" }
                { "type": "array" }
                { "type": "object" }
            ]
        },
        "message": {
            "description": "The log message generated by this event.",
            "type": "string"
        },
        "name": {
            "description": "The name of the event. Absent in reports of `inspect` kind.",
            "type": "string"
        },
        "status": {
            "description": "One of the following strings:

                            * `"success"` - property was out of sync, and was successfully changed to be in sync.
                            * `"failure"`- property was out of sync, and couldn't be changed to be in sync due to an error.
                            * `"noop"` - property was out of sync, and wasn't changed due to noop mode.
                            * `"audit"` - property was in sync, and was being audited.

                           depending on the type of the event. Always "audit" in reports of `inspect` kind.
                           ",
            "enum": ["success", "failure", "noop", "audit"]
        },
        "time": {
            "description": "The time at which the property was evaluated. In ISO 8601 format with 9 characters second-fragment",
            "type": "string"
        },

    "required": [ "audited", "property", "message", "name", "status", "time"],

    "additionalProperties": false
}
